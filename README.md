# MetropolizedForestRecom.jl

[![Test CI](https://github.com/jonmjonm/MetropolizedForestRecom.jl/actions/workflows/ci.yml/badge.svg)](https://github.com/jonmjonm/MetropolizedForestRecom.jl/actions/workflows/ci.yml)

The repository contiunes the development of the code initial housed in the repository [MetropolizedForestRecom-public](https://git.math.duke.edu/gitlab/quantifyinggerrymandering/MetropolizedForestRecom-public). This algorithm was developed in a series of articles: [Metropolized Forest Recombination for Monte Carlo Sampling of Graph Partitions](https://doi.org/10.1137/21M1418010) and [Metropolized Multiscale Forest Recombination for Redistricting](https://doi.org/10.1137/21M1406854). 

Metropolized Forest Recom is able to sample a wide colection of target measures my using a Forest Recom as a proposal to the Metropolis–Hastings algorithm. Our proposal chain modifies the recombination (ReCom) method, which draws spanning trees on joined partitions and then randomly cuts them to repartition. We improve the computational efficiency by augmenting the statespace from partitions to spanning forests. The extra information accelerates the computation of the forward and backward proposal probabilities which are required for the Metropolis–Hastings algorithm. We demonstrate this method by sampling redistricting plans on several measures of interest and find promising convergence results on several key observables of interest. We also explore some limitations in the measures that are efficient to sample from and investigate the feasibility of using parallel tempering to extend this space of measures. The algorithm is also particularly adapted to sampling in a hierarchical tree to help preserve counties or other structures. 